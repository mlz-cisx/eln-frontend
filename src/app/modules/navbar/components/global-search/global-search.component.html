<ng-container *transloco="let t">
  <div #searchDropdown="bs-dropdown" dropdown container="body"
       placement="bottom right" [insideClick]="true">
    <form [formGroup]="form">
      <div class="input-group search-input-group">
        <input
          #searchInput
          type="text"
          id="search-input"
          aria-controls="results-list"
          class="form-control mlzeln-input"
          formControlName="search"
          [placeholder]="t('navbar.globalSearch.placeholder')"
          autocomplete="off"
          dropdownToggle
        />
        <button type="button" class="btn btn-sm bg-transparent clear-input"
                *ngIf="!f.search.value">
          <joeseln-icon className="wb-search"></joeseln-icon>
        </button>
        <button type="button" class="btn btn-sm bg-transparent clear-input"
                (click)="resetSearch()" *ngIf="f.search.value">
          <joeseln-icon className="wb-remove"></joeseln-icon>
        </button>
      </div>
      <ul
        *dropdownMenu
        id="results-list"
        class="dropdown-menu dropdown-menu-right details-dropdown-menu search-dropdown-menu"
        role="menu"
        aria-labelledby="search-input"
      >
        <div class="flex">
          <div
            class="flex flex-col justify-between restrict-search-container pt-1">
            <div>
              <div
                class="font-bold ml-2 mb-2">{{ t('navbar.globalSearch.restrictSearch') }}</div>
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-appointment"-->
              <!--                    name="search-appointment"-->
              <!--                    formControlName="appointment"-->
              <!--                    (change)="onChangeFilter($event, 'shared_elements.meeting')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-appointment">-->
              <!--                    <joeseln-icon [className]="'shared_elements.meeting' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'shared_elements.meeting' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <div
                class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">
                <div class="custom-control custom-checkbox">
                  <input
                    type="checkbox"
                    class="custom-control-input"
                    id="search-note"
                    name="search-note"
                    formControlName="note"
                    (change)="onChangeFilter($event, 'shared_elements.note')"
                  />
                  <label class="custom-control-label w-full font-normal"
                         for="search-note">
                    <joeseln-icon
                      [className]="'shared_elements.note' | formatContentTypeModel: 'icon'"></joeseln-icon>
                    {{ 'shared_elements.note' | formatContentTypeModel: 'translation' }}
                  </label>
                </div>
              </div>
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-contact"-->
              <!--                    name="search-contact"-->
              <!--                    formControlName="contact"-->
              <!--                    (change)="onChangeFilter($event, 'shared_elements.contact')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-contact">-->
              <!--                    <joeseln-icon [className]="'shared_elements.contact' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'shared_elements.contact' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-dmp"-->
              <!--                    name="search-dmp"-->
              <!--                    formControlName="dmp"-->
              <!--                    (change)="onChangeFilter($event, 'dmp.dmp')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-dmp">-->
              <!--                    <joeseln-icon [className]="'dmp.dmp' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'dmp.dmp' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-dss"-->
              <!--                    name="search-dss"-->
              <!--                    formControlName="dss"-->
              <!--                    (change)="onChangeFilter($event, 'dss.dsscontainer')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-dss">-->
              <!--                    <joeseln-icon [className]="'dss.dsscontainer' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'dss.dsscontainer' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <div
                class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">
                <div class="custom-control custom-checkbox">
                  <input
                    type="checkbox"
                    class="custom-control-input"
                    id="search-file"
                    name="search-file"
                    formControlName="file"
                    (change)="onChangeFilter($event, 'shared_elements.file')"
                  />
                  <label class="custom-control-label w-full font-normal"
                         for="search-file">
                    <joeseln-icon
                      [className]="'shared_elements.file' | formatContentTypeModel: 'icon'"></joeseln-icon>
                    {{ 'shared_elements.file' | formatContentTypeModel: 'translation' }}
                  </label>
                </div>
              </div>
              <div
                class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">
                <div class="custom-control custom-checkbox">
                  <input
                    type="checkbox"
                    class="custom-control-input"
                    id="search-labbook"
                    name="search-labbook"
                    formControlName="labbook"
                    (change)="onChangeFilter($event, 'labbooks.labbook')"
                  />
                  <label class="custom-control-label w-full font-normal"
                         for="search-labbook">
                    <joeseln-icon
                      [className]="'labbooks.labbook' | formatContentTypeModel: 'icon'"></joeseln-icon>
                    {{ 'labbooks.labbook' | formatContentTypeModel: 'translation' }}
                  </label>
                </div>
              </div>
              <div
                class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">
                <div class="custom-control custom-checkbox">
                  <input
                    type="checkbox"
                    class="custom-control-input"
                    id="search-picture"
                    name="search-picture"
                    formControlName="picture"
                    (change)="onChangeFilter($event, 'pictures.picture')"
                  />
                  <label class="custom-control-label w-full font-normal"
                         for="search-picture">
                    <joeseln-icon
                      [className]="'pictures.picture' | formatContentTypeModel: 'icon'"></joeseln-icon>
                    {{ 'pictures.picture' | formatContentTypeModel: 'translation' }}
                  </label>
                </div>
              </div>
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-plugin"-->
              <!--                    name="search-plugin"-->
              <!--                    formControlName="plugin"-->
              <!--                    (change)="onChangeFilter($event, 'plugins.plugininstance')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-plugin">-->
              <!--                    <joeseln-icon [className]="'plugins.plugininstance' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'plugins.plugininstance' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-project"-->
              <!--                    name="search-project"-->
              <!--                    formControlName="project"-->
              <!--                    (change)="onChangeFilter($event, 'projects.project')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-project">-->
              <!--                    <joeseln-icon [className]="'projects.project' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'projects.project' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <!--              <div-->
              <!--                class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-resource"-->
              <!--                    name="search-resource"-->
              <!--                    formControlName="resource"-->
              <!--                    (change)="onChangeFilter($event, 'projects.resource')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal"-->
              <!--                         for="search-resource">-->
              <!--                    <joeseln-icon-->
              <!--                      [className]="'projects.resource' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'projects.resource' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-drive"-->
              <!--                    name="search-drive"-->
              <!--                    formControlName="drive"-->
              <!--                    (change)="onChangeFilter($event, 'drives.drive')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-drive">-->
              <!--                    <joeseln-icon [className]="'drives.drive' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'drives.drive' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-task"-->
              <!--                    name="search-task"-->
              <!--                    formControlName="task"-->
              <!--                    (change)="onChangeFilter($event, 'shared_elements.task')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-task">-->
              <!--                    <joeseln-icon [className]="'shared_elements.task' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'shared_elements.task' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
              <!--              <div class="btn mlzeln-button-regular font-normal w-full text-left menu-item-button">-->
              <!--                <div class="custom-control custom-checkbox">-->
              <!--                  <input-->
              <!--                    type="checkbox"-->
              <!--                    class="custom-control-input"-->
              <!--                    id="search-taskboard"-->
              <!--                    name="search-taskboard"-->
              <!--                    formControlName="taskboard"-->
              <!--                    (change)="onChangeFilter($event, 'kanban_boards.kanbanboard')"-->
              <!--                  />-->
              <!--                  <label class="custom-control-label w-full font-normal" for="search-taskboard">-->
              <!--                    <joeseln-icon [className]="'kanban_boards.kanbanboard' | formatContentTypeModel: 'icon'"></joeseln-icon>-->
              <!--                    {{ 'kanban_boards.kanbanboard' | formatContentTypeModel: 'translation' }}-->
              <!--                  </label>-->
              <!--                </div>-->
              <!--              </div>-->
            </div>
          </div>
          <ng-container *ngIf="searchText">
            <mlzeln-loading class="loading" [loading]="loading">
              <div class="results-container">
                <ng-container *ngFor="let result of results">
                  <a
                    [routerLink]="[result.pk]"
                    (click)="hideDropdown(result.labbook_pos_y, result.element_pk, result.content_type_model)"
                  >
                    <li role="menuitem"
                        class="btn mlzeln-button-regular text-left h-auto w-full pt-1 pb-1 border-b menu-item">
                      <div class="flex">
                        <joeseln-icon
                          [className]="result.content_type_model | formatContentTypeModel: 'icon'"
                          class="result-icon self-center"
                        ></joeseln-icon>
                        <div class="ml-2">
                          <div
                            class="result-name truncate">{{ result.display }}</div>
                          <div class="flex whitespace-nowrap font-normal">
                            {{ t('navbar.globalSearch.createdBy') }}
                            <mlzeln-user-details [user]="result.created_by"
                                                     [modal]="false"
                                                     class="ml-1"></mlzeln-user-details>
                          </div>
                        </div>
                      </div>
                    </li>
                  </a>
                </ng-container>
              </div>
            </mlzeln-loading>
          </ng-container>
        </div>
      </ul>
    </form>
  </div>
</ng-container>
