<!--
  Copyright (C) 2016-2020 TU Muenchen and contributors of ANEXIA Internetdienstleistungs GmbH
  SPDX-License-Identifier: AGPL-3.0-or-later
-->

<ng-container *transloco="let t">
  <!--  <eworkbench-header [title]="detailsTitle">-->
  <!--    <ng-container slot="elements" *ngIf="initialState">-->
  <!--<button type="button" class="btn ewb-button-big" style="color: white" (click)="go_to_note()">Go to Note in Labbook</button>-->
  <!--      <eworkbench-favorite-button-->
  <!--        class="inline-block mr-2"-->
  <!--        [id]="initialState?.pk"-->
  <!--        [contentType]="initialState?.content_type"-->
  <!--        [favorited]="initialState?.is_favourite"-->
  <!--        btnClass="btn bg-transparent ewb-button-big square-md text-white"-->
  <!--      ></eworkbench-favorite-button>-->
  <div style="text-align: center"><strong>{{detailsTitle}}</strong>
    <eworkbench-details-dropdown
      [service]="admin_users_service"
      [id]="id"
      [redirectDestination]="[showSidebar ? '.' : '' + '/admin/users', id]"
      [newModalComponent]="newModalComponent"
      [initialState]="initialState"
      [privileges]="privileges"
      *ngIf="privileges"
    ></eworkbench-details-dropdown>
  </div>
  <!--    </ng-container>-->
  <!--  </eworkbench-header>-->
</ng-container>

<div *ngIf="!initialState" [class.with-sidebar]="showSidebar">
  <aside *ngIf="showSidebar">
    <eworkbench-sidebar-skeleton></eworkbench-sidebar-skeleton>
  </aside>
  <div class="skeleton-wrapper">
    <div class="note mb-5">
      <div>
        <!--        <eworkbench-details-skeleton [fields]="3" [header]="true" class="mb-6"></eworkbench-details-skeleton>-->
        <!--        <eworkbench-wysiwyg-skeleton class="mb-6"></eworkbench-wysiwyg-skeleton>-->
        <!--        <eworkbench-details-skeleton [fields]="1" [header]="true"></eworkbench-details-skeleton>-->
      </div>
      <div>
        <!--        <eworkbench-list-skeleton [lines]="5" [header]="true" [collapseHeader]="true"></eworkbench-list-skeleton>-->
      </div>
      <div>
        <!--        <eworkbench-list-skeleton [lines]="5" [header]="true" [collapseHeader]="true" class="mb-6"></eworkbench-list-skeleton>-->
        <!--        <eworkbench-list-skeleton [lines]="5" [header]="true" [collapseHeader]="true" class="mb-6"></eworkbench-list-skeleton>-->
        <!--        <eworkbench-comment-skeleton [fields]="3" [header]="true"></eworkbench-comment-skeleton>-->
      </div>
    </div>
  </div>
</div>

<ng-container *ngIf="initialState">
  <ng-container *transloco="let t">
    <div [class.with-sidebar]="showSidebar">
      <aside *ngIf="showSidebar">
        <!--        <eworkbench-project-sidebar></eworkbench-project-sidebar>-->
      </aside>
      <main>
        <!--        <ng-container *ngIf="initialState?.deleted">-->
        <!--&lt;!&ndash;          <eworkbench-trash-notice></eworkbench-trash-notice>&ndash;&gt;-->
        <!--        </ng-container>-->
        <!--        <eworkbench-lock [id]="id" [lock]="lock" [lockUser]="lockUser" [modified]="modified" [service]="notesService"></eworkbench-lock>-->
        <form [formGroup]="form" (ngSubmit)="onSubmit()" class="note"
              errorTailor>
          <div>
            <eworkbench-details-collapse-element
              [labelText]="t('note.details.element.details')">
              <ng-container slot="body">
                <div class="mb-4">
                  <eworkbench-form-input
                    for="username"
                    [label]="t('user.details.username.label')"
                    [loading]="loading"
                    [onSubmit]="refreshResetValue"
                    [required]="true"
                  >
                    <input
                      type="text"
                      class="form-control ewb-input"
                      id="username"
                      formControlName="username"
                      name="username"
                      [placeholder]="t('user.details.username.placeholder')"
                      slot="input"
                    />
                  </eworkbench-form-input>
                </div>

                <div class="mb-4">
                  <eworkbench-form-input
                    for="first_name"
                    [label]="t('user.details.first_name.label')"
                    [loading]="loading"
                    [onSubmit]="refreshResetValue"
                    [required]="true"
                  >
                    <input
                      type="text"
                      class="form-control ewb-input"
                      id="first_name"
                      formControlName="first_name"
                      name="first_name"
                      [placeholder]="t('user.details.first_name.placeholder')"
                      slot="input"
                    />
                  </eworkbench-form-input>
                </div>
                <div class="mb-4">
                  <eworkbench-form-input
                    for="last_name"
                    [label]="t('user.details.last_name.label')"
                    [loading]="loading"
                    [onSubmit]="refreshResetValue"
                    [required]="true"
                  >
                    <input
                      type="text"
                      class="form-control ewb-input"
                      id="last_name"
                      formControlName="last_name"
                      name="last_name"
                      [placeholder]="t('user.details.last_name.placeholder')"
                      slot="input"
                    />
                  </eworkbench-form-input>
                </div>

                <div class="mb-4">
                  <eworkbench-form-input
                    for="user_email"
                    [label]="t('user.details.email.label')"
                    [loading]="loading"
                    [onSubmit]="refreshResetValue"
                    [required]="true"
                  >
                    <input
                      type="text"
                      class="form-control ewb-input"
                      id="user_email"
                      formControlName="user_email"
                      name="user_email"
                      [placeholder]="t('user.details.email.placeholder')"
                      slot="input"
                    />
                  </eworkbench-form-input>
                </div>


                <!--                <div class="mb-4">-->
                <!--                  <eworkbench-form-input-->
                <!--                    for="projects"-->
                <!--                    [label]="t('note.details.projects.label')"-->
                <!--                    [loading]="loading"-->
                <!--                    [onSubmit]="refreshResetValue"-->
                <!--                  >-->
                <!--                    <ng-select-->
                <!--                      class="ewb-select"-->
                <!--                      formControlName="projects"-->
                <!--                      labelForId="projects"-->
                <!--                      name="projects"-->
                <!--                      [placeholder]="t('note.details.projects.placeholder')"-->
                <!--                      [multiple]="true"-->
                <!--                      [typeahead]="projectInput$"-->
                <!--                      [items]="projects"-->
                <!--                      groupBy="is_favourite"-->
                <!--                      bindLabel="name"-->
                <!--                      bindValue="pk"-->
                <!--                      slot="input"-->
                <!--                    >-->
                <!--                      <ng-template ng-label-tmp let-item="item"-->
                <!--                                   let-clear="clear">-->
                <!--                        {{ item.name }}-->
                <!--                        <span class="ng-value-icon left" (click)="clear(item)"-->
                <!--                              aria-hidden="true">Ã—</span>-->
                <!--                      </ng-template>-->
                <!--                      <ng-template ng-option-tmp let-item="item"-->
                <!--                                   let-search="searchTerm">-->
                <!--                        <joeseln-icon className="wb-favorite-3"-->
                <!--                                      class="favorite-icon"-->
                <!--                                      *ngIf="item.is_favourite"></joeseln-icon>-->
                <!--                        <span-->
                <!--                          [ngOptionHighlight]="search">{{ item.name }}</span>-->
                <!--                      </ng-template>-->
                <!--                      <ng-template ng-optgroup-tmp let-item="item">-->
                <!--                        <ng-container-->
                <!--                          *ngIf="item.is_favourite">{{ t('formInput.select.optgroup.favorite') }}</ng-container>-->
                <!--                        <ng-container-->
                <!--                          *ngIf="!item.is_favourite">{{ t('formInput.select.optgroup.other') }}</ng-container>-->
                <!--                      </ng-template>-->
                <!--                      <ng-template ng-notfound-tmp>-->
                <!--                        <div-->
                <!--                          class="ng-option">{{ t('formInput.select.noMatch') }}</div>-->
                <!--                      </ng-template>-->
                <!--                    </ng-select>-->
                <!--                  </eworkbench-form-input>-->
                <!--                </div>-->
                <!--                <div class="mb-4">-->
                <!--                  <label-->
                <!--                    for="created-by">{{ t('note.details.createdBy.label') }}</label>-->
                <!--                  <div class="flex items-center space-x-1">-->
                <!--                    &lt;!&ndash;                    <eworkbench-user-details&ndash;&gt;-->
                <!--                    &lt;!&ndash;                      id="created-by"&ndash;&gt;-->
                <!--                    &lt;!&ndash;                      class="inline-block"&ndash;&gt;-->
                <!--                    &lt;!&ndash;                      [user]="initialState?.created_by"&ndash;&gt;-->
                <!--                    &lt;!&ndash;                    ></eworkbench-user-details>&ndash;&gt;-->
                <!--                    <span> | </span>-->
                <!--                    &lt;!&ndash;                    <span id="created-at">{{ initialState?.created_at | formatDate }}</span>&ndash;&gt;-->
                <!--                  </div>-->
                <!--                </div>-->
                <!--                <div class="mb-4">-->
                <!--                  &lt;!&ndash;                  <label for="last-modified-by">{{ t('note.details.lastModifiedBy.label') }}</label>&ndash;&gt;-->
                <!--                  <div class="flex items-center space-x-1">-->
                <!--                    &lt;!&ndash;                    <eworkbench-user-details id="last-modified-by" class="inline-block" [user]="initialState?.last_modified_by">&ndash;&gt;-->
                <!--                    &lt;!&ndash;                    </eworkbench-user-details>&ndash;&gt;-->
                <!--                    <span> | </span>-->
                <!--                    &lt;!&ndash;                    <span id="last-modified-at">{{ initialState?.last_modified_at | formatDate }}</span>&ndash;&gt;-->
                <!--                  </div>-->
                <!--                </div>-->
                <!--                <div class="mb-4">-->
                <!--                  <eworkbench-form-input-->
                <!--                    for="content"-->
                <!--                    [label]="t('note.details.content.label')"-->
                <!--                    [loading]="loading"-->
                <!--                    [onSubmit]="refreshResetValue"-->
                <!--                  >-->
                <!--                    <eworkbench-wysiwyg-editor [id]="'content'"-->
                <!--                                               formControlName="content"-->
                <!--                                               slot="input"-->
                <!--                                               [disabled]="loading || !privileges?.fullAccess"-->
                <!--                                               toolbar="-&#45;&#45;">-->
                <!--                    </eworkbench-wysiwyg-editor>-->
                <!--                  </eworkbench-form-input>-->
                <!--                </div>-->
              </ng-container>
            </eworkbench-details-collapse-element>

            <!--            <eworkbench-details-collapse-element-->
            <!--              [labelText]="t('note.details.element.metadata')">-->
            <!--              <ng-container slot="body">-->
            <!--                <div class="mb-4">-->
            <!--                  &lt;!&ndash;                  <eworkbench-metadata&ndash;&gt;-->
            <!--                  &lt;!&ndash;                    [selectedParameters]="initialState?.metadata ?? []"&ndash;&gt;-->
            <!--                  &lt;!&ndash;                    [editable]="privileges?.edit"&ndash;&gt;-->
            <!--                  &lt;!&ndash;                    [loading]="loading"&ndash;&gt;-->
            <!--                  &lt;!&ndash;                    [refresh]="refreshMetadata"&ndash;&gt;-->
            <!--                  &lt;!&ndash;                    (changed)="onUpdateMetadata($event)"&ndash;&gt;-->
            <!--                  &lt;!&ndash;                  ></eworkbench-metadata>&ndash;&gt;-->
            <!--                </div>-->
            <!--              </ng-container>-->
            <!--            </eworkbench-details-collapse-element>-->
          </div>
          <div>
            <eworkbench-details-collapse-element
              [labelText]="t('note.details.element.links')">
              <ng-container slot="actions">
                <!--                <eworkbench-link-->
                <!--                  [baseModel]="initialState"-->
                <!--                  [service]="notesService"-->
                <!--                  (refreshLinkList)="onRefreshLinkList()"-->
                <!--                ></eworkbench-link>-->
              </ng-container>
              <ng-container slot="body">
                <!--                <eworkbench-link-list [id]="initialState.pk" [service]="notesService" [refresh]="refreshLinkList"></eworkbench-link-list>-->
              </ng-container>
            </eworkbench-details-collapse-element>
          </div>
          <div>
<!--            <eworkbench-details-collapse-element-->
<!--              [labelText]="t('note.details.element.recentChanges')">-->
<!--              <ng-container slot="body">-->
<!--                &lt;!&ndash;                <eworkbench-recent-changes&ndash;&gt;-->
<!--                &lt;!&ndash;                  id="recent-changes"&ndash;&gt;-->
<!--                &lt;!&ndash;                  [service]="admin_users_service"&ndash;&gt;-->
<!--                &lt;!&ndash;                  [changesId]="id"&ndash;&gt;-->
<!--                &lt;!&ndash;                  [refresh]="refreshChanges"&ndash;&gt;-->
<!--                &lt;!&ndash;                ></eworkbench-recent-changes>&ndash;&gt;-->
<!--              </ng-container>-->
<!--            </eworkbench-details-collapse-element>-->

            <eworkbench-details-collapse-element
              [labelText]="t('note.details.element.versions')">
              <ng-container slot="body">
                <!--                <eworkbench-versions-->
                <!--                  id="versions"-->
                <!--                  contentType="note"-->
                <!--                  [service]="admin_users_service"-->
                <!--                  [versionId]="id"-->
                <!--                  [lastModifiedAt]="initialState?.last_modified_at"-->
                <!--                  [refresh]="refreshVersions"-->
                <!--                  [editable]="privileges?.restore"-->
                <!--                  (changed)="onVersionChanged()"-->
                <!--                ></eworkbench-versions>-->
              </ng-container>
            </eworkbench-details-collapse-element>

            <eworkbench-details-collapse-element
              [labelText]="t('note.details.element.comments')">
              <ng-container slot="actions">
                <button
                  type="button"
                  class="btn ewb-button-regular ewb-button-outline"
                  (click)="onOpenNewCommentModal()"
                  [disabled]="loading"
                >
                  {{ t('note.details.comments.newComment') }}
                </button>
              </ng-container>
              <ng-container slot="body">
                <!--                <eworkbench-comments-->
                <!--                  #comments-->
                <!--                  [service]="notesService"-->
                <!--                  [id]="id"-->
                <!--                  [contentType]="initialState.content_type"-->
                <!--                ></eworkbench-comments>-->
              </ng-container>
            </eworkbench-details-collapse-element>
          </div>
        </form>


        <form [formGroup]="passwword_form" (ngSubmit)="password_reset()"
              errorTailor>
          <div class="mb-4">
            <ng-container slot="body">
              <div class="mb-4">
                <eworkbench-form-input
                  for="password_patch"
                  [label]="t('user.details.password_reset.label')"
                  [loading]="loading"
                  [onSubmit]="refreshResetValue"
                  [required]="true"
                >
                  <input style="width: 30%"
                         type="password"
                         autocomplete="off"
                         readonly
                         onfocus="this.removeAttribute('readonly');"
                         class="form-control ewb-input"
                         id="password_patch"
                         formControlName="password_patch"
                         name="password_patch"
                         slot="input"
                  />
                </eworkbench-form-input>
              </div>
            </ng-container>
          </div>
        </form>

        <div style="width: 30%">Password must contain at least one lowercase
          letter, one uppercase letter, one digit, one special character, and
          must be between eight
          and sixteen characters in length.
        </div>

      </main>
    </div>
  </ng-container>
</ng-container>
